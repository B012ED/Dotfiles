#!/bin/bash

WALLPAPER_DIR="$HOME/.config/wallpapers"
MONITOR_NAME="HDMI-A-1" # PASTIKAN INI SAMA DENGAN NAMA MONITOR ANDA


if [ -z "$1" ]; then
    echo "Penggunaan: yusawall <nama_gambar>"; exit 1
fi
if ! command -v wal &> /dev/null; then
    echo "Error: pywal ('wal') tidak ditemukan."; exit 1
fi


WALLPAPER_PATH="$WALLPAPER_DIR/$1" 
if [ ! -f "$WALLPAPER_PATH" ]; then
    echo "Error: File wallpaper tidak ditemukan di: $WALLPAPER_PATH"; exit 1
fi


wal -i "$WALLPAPER_PATH"


echo "Mengatur wallpaper di Hyprland..."


if ! pgrep -x hyprpaper > /dev/null; then
    hyprctl dispatch exec hyprpaper &
    sleep 0.5
fi


hyprctl hyprpaper preload "$WALLPAPER_PATH"
hyprctl hyprpaper wallpaper "$MONITOR_NAME,$WALLPAPER_PATH"

echo "Wallpaper di monitor $MONITOR_NAME telah diubah."


echo "Memuat ulang Waybar untuk menerapkan skema warna..."

pkill waybar 2>/dev/null
sleep 1.5 # Jeda 1.5 detik untuk stabilitas Waybar

waybar > /dev/null 2>&1 &
